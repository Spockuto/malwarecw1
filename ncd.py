import os 
import lzma
import matplotlib.pyplot as plt
import numpy as np

def ncd (path1 , path2) :
    file1 = open(path1, "rb").read()
    file2 = open(path2, "rb").read()
    zx = len(lzma.compress(file1))
    zy = len(lzma.compress(file2))
    zxy = len(lzma.compress(file1 + file2))
    score = (zxy - min (zx , zy)) / max(zx , zy)
    print("zx: " + str(zx) + " zy: " + str(zy) + " zxy: " + str(zxy) + " score: " + str(score))
    return score

cwd =  os.getcwd()

testFileDir = "g17"
classFileDir = "fileClasses"

testFilePath = [[each, os.path.abspath(testFileDir + "/" + each)] for each in os.listdir(cwd + "/" + testFileDir)]
classFilePath = [[each, os.path.abspath(classFileDir + "/" + each)] for each in os.listdir(cwd + "/" + classFileDir)]
classFilePath.sort()
testFilePath.sort()
totalPath  = classFilePath + testFilePath 
names = [each[0] for each in totalPath]
matrixSize = len(classFilePath) + len (testFilePath)
plot = np.zeros((matrixSize, matrixSize))

for i, file1 in enumerate(totalPath) :
    for j, file2 in enumerate(totalPath) :
        plot[i][j] =  ncd(file1[1], file2[1])

plt.matshow(plot, cmap=plt.get_cmap('gray'))
plt.title("Similarity Matrix")
plt.colorbar()
plt.show()
